kind: pipeline
type: docker
name: makedeb - stable
trigger:
  event:
    - push
  branch:
    - stable
  paths:
    - PKGBUILD
    - .drone/trigger

steps:
  - name: build
    image: ubuntu
    commands:
      - release_type=stable
      - bash .drone/build.sh

  - name: publish
    image: ubuntu
    shell: bash
    environment:
      nexus_pass:
        from_secret: repo_pass
    commands:
      - bash .drone/publish.sh

---
kind: pipeline
type: docker
name: makedeb - alpha
trigger:
  event:
    - push
  branch:
    - alpha
  paths:
    - PKGBUILD
    - .drone/trigger

steps:
  - name: build
    image: ubuntu
    commands:
      - export pkgname=makedeb-alpha
      - export release_type=alpha
      - bash .drone/build.sh

  - name: publish
    image: ubuntu
    shell: bash
    environment:
      nexus_pass:
        from_secret: nexus_pass
    commands:
      - bash .drone/publish.sh
